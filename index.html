<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>芋財訂購系統</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f5f0ff; padding: 20px; display: flex; justify-content: center; }
        .order-container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; width: 100%; border-top: 8px solid #8e67ab; }
        h1 { text-align: center; color: #5d3b7d; margin-bottom: 25px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #444; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        textarea { height: 100px; resize: vertical; }
        .section-header { background: #efe6ff; padding: 10px; border-radius: 5px; margin: 20px 0 10px; color: #5d3b7d; font-weight: bold; border-left: 4px solid #8e67ab; }
        .btn-submit { width: 100%; background-color: #8e67ab; color: white; padding: 15px; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 20px; }
        .btn-submit:hover { background-color: #6d4a8d; }
    </style>
</head>
<body>

<div class="order-container">
    <h1> 芋財訂購 </h1>
    
    <form id="orderForm">
        <div class="form-group">
            <label>訂購人姓名：</label>
            <input type="text" id="userName" placeholder="請輸入姓名" required>
        </div>
        <div class="form-group">
            <label>聯絡電話：</label>
            <input type="tel" id="userPhone" placeholder="請輸入電話" required>
        </div>

        <div class="section-header">【帶皮】規格選擇</div>
        <div class="form-group">
            <label>品項：</label>
            <select id="peeledOption">
                <option value="無">不需要</option>
                <option value="上芋">上芋</option>
                <option value="中芋">中芋</option>
                <option value="下芋">下芋</option>
            </select>
        </div>

        <div class="section-header">【未帶皮】加工方式</div>
        <div class="form-group">
            <label>芋角/芋丁/芋泥/芋條：</label>
            <select id="processedOption">
                <option value="無">不需要</option>
                <option value="芋角-芋塊">芋角-芋塊</option>
                <option value="芋丁-10mm">芋丁 (10mm)</option>
                <option value="芋丁-20mm">芋丁 (20mm)</option>
                <option value="芋條">芋條</option>
                <option value="芋泥">芋泥</option>
            </select>
        </div>
        <div class="form-group">
            <label>芋圓系列：</label>
            <select id="taroBallOption">
                <option value="無">不需要</option>
                <option value="大芋圓">大芋圓</option>
                <option value="小芋圓">小芋圓</option>
            </select>
        </div>

    <div class="section">
        <div class="section-title">3. 地址與備註</div>
        <textarea id="remarks" placeholder="請輸入配送地址與注意事項..."></textarea>
    </div>

    <button class="btn" id="submitBtn" onclick="sendEmail()">提交訂單並發送郵件</button>
</div>

<script>
    function sendEmail() {
        const btn = document.getElementById('submitBtn');
        const customer = document.getElementById('customer_info').value;

        // 檢查是否填寫基本資訊
        if(!customer) { 
            alert("請填寫聯絡資訊 (姓名與電話)"); 
            return; 
        }

        btn.disabled = true;
        btn.innerText = "傳送中...";

        // 按照您要求的邏輯抓取數值
        const params = {
            customer: customer,
            // 抓取下拉選單顯示的文字
            grade: document.getElementById('grade').options[document.getElementById('grade').selectedIndex].text,
            process: document.getElementById('processType').options[document.getElementById('processType').selectedIndex].text,
            taroBall: document.getElementById('taroBall').options[document.getElementById('taroBall').selectedIndex].text,
            remarks: document.getElementById('remarks').value || "無"
        };

        // 偵錯用：可以在 Console 查看抓到的資料
        console.log("寄送資料：", params);

        emailjs.send("service_j87feij", "template_1mucf6o", params)
            .then(function() {
                alert("訂單已成功寄送到老闆信箱！");
                btn.disabled = false;
                btn.innerText = "提交訂單並發送郵件";
                // 選項：成功後清空表單
                // location.reload();
            }, function(error) {
                alert("傳送失敗，請檢查設定或連繫老闆");
                console.log("FAILED...", error);
                btn.disabled = false;
                btn.innerText = "提交訂單並發送郵件";
            });
    }
</script>

</body>
</html>
